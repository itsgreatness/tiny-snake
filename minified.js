!function(){"use strict";var e,o=this&&this.__spreadArray||function(e,o,l){if(l||2===arguments.length)for(var t,i=0,a=o.length;i<a;i++)!t&&i in o||(t||(t=Array.prototype.slice.call(o,0,i)),t[i]=o[i]);return e.concat(t||Array.prototype.slice.call(o))};if("boolean"!=typeof globalThis.globalThis.active){var l,t,i=function(e){void 0===e&&(e=3e3),globalThis.clearTimeout(l),!0===globalThis.active?(l=globalThis.setTimeout((function(){globalThis.PAUSED=!1,requestAnimationFrame(globalThis.mainloop)}),e),globalThis.popup.style.display="inline-block",globalThis.popup.focus()):(globalThis.PAUSED=!0,globalThis.active=!1,globalThis.popup.style.display="none",globalThis.focusedElement.focus())},a=document.activeElement;globalThis.active=null===(e=!globalThis.active)||void 0===e||e;var n=[0,0],s=!1;globalThis.popup=document.createElement("div"),globalThis.popup.id="game",globalThis.popup.tabIndex=0,globalThis.popup.style.all="initial",globalThis.popup.style.display="inline-block",globalThis.popup.style.position="fixed",globalThis.popup.style.left="0px",globalThis.popup.style.top="0px",globalThis.popup.style.margin="0",globalThis.popup.style.padding="0",globalThis.popup.style.zIndex="9999",globalThis.popup.addEventListener("mousedown",(function(e){s=!0,n=[globalThis.popup.offsetLeft-e.clientX,globalThis.popup.offsetTop-e.clientY]}),!0),document.addEventListener("mouseup",(function(){s=!1}),!0),document.addEventListener("mousemove",(function(e){e.preventDefault(),s&&(t={x:e.clientX,y:e.clientY},globalThis.popup.style.left="".concat(t.x+n[0],"px"),globalThis.popup.style.top="".concat(t.y+n[1],"px"))}),!0),document.addEventListener("focus",(function(e){a=document.activeElement===globalThis.popup?a:document.activeElement}),!0),document.body.appendChild(globalThis.popup),globalThis.popup.focus();var p=Math.abs,c=Math.floor,r=Math.ceil,u=Math.max,h=function(e,o){return c(Math.random()*(c(o)-r(e))+r(e))},g=function(e){return 1-p(e-2)},f=function(e){return Symbol.for(JSON.stringify(e))},y=24,d=24,b=16,T=new Array(d).fill(new Array(y).fill(0)),m=[{x:c(6),y:c(12)}],v=1,x=4,w={x:h(0,y),y:h(0,d)},E=0,A=!1,L=document.createElement("canvas");L.width=384,L.height=384,globalThis.popup.style.width="".concat(L.width,"px"),globalThis.popup.style.height="".concat(L.height,"px");var S=document.getElementById("game");null==S||S.appendChild(L);var M=L.getContext("2d");document.addEventListener("keydown",(function(e){if(e.preventDefault(),e.stopPropagation(),e.ctrlKey&&2===e.location)return globalThis.active=!globalThis.active,i();if(A)return"enter"===e.key.toLowerCase()?C():void 0;var o=function(){switch(e.key.toLowerCase()){case"arrowdown":case"s":return 2;case"arrowup":case"w":return 0;case"arrowleft":case"a":return 3;case"arrowright":case"d":return 1;default:return v}}();v+=p(p(o-v)-2)*(o-v)}),!0);var k=function(){globalThis.active&&(T.fill(new Array(y).fill(0)),T[u(0,w.y)]=o(o(o([],T[u(0,w.y)].slice(0,u(0,w.x)),!0),[2],!1),T[u(0,w.y)].slice(u(0,w.x)+1,T[u(0,w.y)].length),!0),m.forEach((function(e){try{T[u(0,e.y)]=o(o(o([],T[u(0,e.y)].slice(0,u(0,e.x)),!0),[1],!1),T[u(0,e.y)].slice(u(0,e.x)+1,T[u(0,e.y)].length),!0)}catch(e){A=!0}})),T.forEach((function(e,o){e.forEach((function(e,l){M&&(M.fillStyle=["green","blue","red"][e],M.fillRect(l*b,o*b,b,b))}))})),M&&(M.fillStyle="white",M.font="bold ".concat(12,"px sans-serif"),M.fillText(E.toString(),16,32))),requestAnimationFrame(k)},C=function(){A&&(m=[{x:c(6),y:c(12)}],v=1,x=4,w={x:h(0,y),y:h(0,d)},E=0,A=!1,i(0))};globalThis.mainloop=function(){var e,o,l;A||(m.unshift({x:m[0].x+(e=v,1-p(e-1)),y:m[0].y+g(v)}),(m=m.slice(0,x))[0].x==w.x&&m[0].y==w.y&&(E+=1,x+=1,w={x:h(0,y),y:h(0,d)}),(m[0].x>=y||m[0].x<0||m[0].y>=d||m[0].y<0)&&(A=!0),l={},(o=m).forEach((function(e,o){l.hasOwnProperty(f(e))||(l[f(e)]=o)})),o.some((function(e,o){return l[f(e)]!=o}))&&(A=!0),window.setTimeout(requestAnimationFrame,62.5,globalThis.mainloop))},requestAnimationFrame(k),i()}else globalThis.active=!globalThis.active,globalThis.toggleModal()}();